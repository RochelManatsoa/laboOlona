# This file is the entry point to configure your own services.
# Files in the packages/ subdirectory configure your dependencies.

# Put parameters here that don't need to change on each machine where the app is deployed
# https://symfony.com/doc/current/best_practices.html#use-parameters-for-application-configuration
parameters:
    cv_expert: /uploads/experts
    medias_prestation: /uploads/prestations
    logo_company: /uploads/compagnies
    job_listing_image: /uploads/annonces
    white_label.client1.host: ['client1.olona-talents.local.com:8000', 'client1.olona-talents.com']
    app.main.host: ['localhost:8000', '127.0.0.1:8000', 'dev.olona-talents.com', 'olona-talents.com']
    white_label.client1.host_regex: '/^(client1\.olona-talents\.local\.com|client1\.olona-talents\.com)$/'
    app.host_regex: '/^(localhost|127\.0\.0\.1|dev\.olona-talents\.com|olona-talents\.com)$/'
    app.locales: [en, fr]
    cv_directory: '%kernel.project_dir%/public/uploads/cv'
    csv_directory: '%kernel.project_dir%/public/uploads/csv'
    wl_client1_directory: '%kernel.project_dir%/public/wl/client1'
    app.env: '%env(APP_ENV)%'
    google_drive.credentials_path: '%kernel.project_dir%/config/google/credentials.json'
    google_drive.token_path: '%kernel.project_dir%/config/google/token.json'

services:
    # default configuration for services in *this* file
    _defaults:
        autowire: true      # Automatically injects dependencies in your services.
        autoconfigure: true # Automatically registers your services as commands, event subscribers, etc.

    # makes classes in src/ available to be used as services
    # this creates a service per class whose id is the fully-qualified class name
    App\:
        resource: '../src/'
        exclude:
            - '../src/DependencyInjection/'
            - '../src/Entity/'
            - '../src/Kernel.php'

    # add more service definitions when explicit configuration is needed
    # please note that last definitions always *replace* previous ones

    App\Service\FileUploader:
        arguments:
            $targetDirectory: '%kernel.project_dir%/public/uploads/cv'
            $targetDirectoryEdited: '%kernel.project_dir%/public/uploads/cv/edited'
            $targetDirectoryEditedOlona: '%kernel.project_dir%/public/uploads/cv/olona'


    App\Service\WooCommerce:
        arguments: ['%env(WC_CUSTOMER_ENDPOINT)%', '%env(WC_CUSTOMER_KEY)%', '%env(WC_CUSTOMER_SECRET)%']  
        
    App\Service\OpenAITranslator:
        arguments:
            $apiKey: '%env(OPENAI_API_KEY)%' # Assurez-vous que cette variable d'environnement est d√©finie

    App\WhiteLabel\Service\Client1\OpenAITranslator:
        arguments:
            $apiKey: '%env(OPENAI_API_KEY)%'

    App\Controller\YouTubeOAuthController:
        public: true
        arguments:
            $clientId: '%env(YOUTUBE_CLIENT_ID)%'
            $clientSecret: '%env(YOUTUBE_CLIENT_SECRET)%'
            $redirectUri: '%env(YOUTUBE_CLIENT_REDIRECT)%'

    App\Service\YouTubeService:
        arguments:
            $apiKey: '%env(YOUTUBE_API_KEY)%'
    
    # App\EventListener\ExceptionListener:
    #    tags:
    #        - { name: kernel.event_listener, event: kernel.exception, priority: 10 }
    #    arguments:
    #        - '@twig'

    App\WhiteLabel\Service\Client1\GoogleDriveService:
        arguments:
            $credentialsPath: '%google_drive.credentials_path%'
            $tokenPath: '%google_drive.token_path%'

    App\WhiteLabel\Service\Client1\FileUploader:
        arguments:
            $targetDirectory: '%wl_client1_directory%'
            
    App\OAuth\GoogleDriveClient:
        alias: KnpU\OAuth2ClientBundle\Client\Provider\GoogleClient

    App\EventListener\RedirectToHomeListener:
        arguments:
            $targetHosts: '%white_label.client1.host%'
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }

    App\Manager\Facebook\FacebookTokenManager:
        arguments:
            $userToken: '%env(FACEBOOK_USER_LONG_TOKEN)%'
            $pageName: '%env(FACEBOOK_PAGE_NAME)%'
    
    App\Service\JitsiMeetService:
        arguments:
            $domain: 'meet.olona-talents.com'
            
    # App\Service\ErrorLogger:
    #     tags:
    #         - { name: 'kernel.event_listener', event: 'kernel.exception', method: 'onKernelException', priority: 100 }

    App\Service\ElasticsearchService:
        arguments: []
        
    App\Service\PaymentService:
        arguments:
            $clientId: '%env(PAYPAL_CLIENT_ID)%'
            $clientSecret: '%env(PAYPAL_CLIENT_SECRET)%'
            $mode: '%env(PAYPAL_MODE)%'
            
    App\Service\PdfService:
        arguments:
            $wkhtmltopdfPath: '%env(WKHTMLTOPDF_PATH)%'

    App\Security\Firewall\RequestMatcherClient1:
        public: true
        tags:
            - { name: security.request_matcher }

    App\Security\AppAuthenticator:
        arguments:
            $client1Hosts: '%white_label.client1.host%'

    app.sitemap.blog_post_subscriber:
        class: App\EventListener\SitemapSubscriber
        arguments:
            - '@App\Repository\Blog\PostRepository'
            - '@App\Repository\Blog\CategoryRepository'
        tags:
            - { name: "kernel.event_subscriber", priority: 100 }
        
    App\Service\MobileMoney\AirtelMoneyService:
        arguments:
            $clientId: '%env(AIRTEL_CLIENT_ID)%'
            $clientSecret: '%env(AIRTEL_CLIENT_SECRET)%'
            $apiUrl: '%env(AIRTEL_API_URL)%'

    App\WhiteLabel\Manager\Client1\CsvUploadManager:
        arguments:
            $entityManager: '@doctrine.orm.client1_entity_manager'
            
    App\WhiteLabel\Manager\Client1\CVThequeManager:
        arguments:
            $em: '@doctrine.orm.client1_entity_manager'
